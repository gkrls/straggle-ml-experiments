[lstm.sh.29996] iface=ens4f1 ip=42.0.1.1 rank=0 world_size=6 master=42.0.1.1:29500 backend=dpa_dpdk
+ GDB='gdb -ex run --args'
++ which python
+ sudo -E /home/gks/straggle-ml-experiments/venv/bin/python experiments/train/lstm.py --rank 0 --world_size 6 --iface ens4f1 --master_addr 42.0.1.1 --master_port 29500 --dpa_conf /home/gks/straggle-ml-experiments/configs/edgecore.json --backend dpa_dpdk --wor
kers 4 --prefetch_factor 4 --hint_tensor_size 100000000 --hint_tensor_count 5 --json experiments/train/lstm.json --deterministic --epochs 12 --batch_size 32
dpa: reading DPDK backend options from config.json: /home/gks/straggle-ml-experiments/configs/edgecore.json
dpa: [warn] session.pool.seqnums not supplied => assuming 1,1,1...
dpa: Using address '42.0.1.1', inferred from iface 'ens4f1'
dpa: ====================================================================================================
dpa: context: rank=0 world=6 build=0.1.0-Release avx=2
dpa: device : edgecore-dcs810 42.0.1.0:4242 pipes=4 quants=1 reducers=32 mode=2 slots=16384 straggle_aware=true
dpa:          session.1
dpa:           slots_pool_alloc: 0-16384
dpa:           starting_seqnums: 1,1,1,1 ... 1,1,1,1
dpa:           straggle_timeout: 1000.00 ms
dpa:           gress_drops_prob: 0.00/0.00 %
dpa: backend: dpa-dpdk 42.0.1.1:4242, iface 'ens4f1' threads 4 (async) window 512 subpool 0-4096 (12288 unused) loop_ns=no
dpa:      max_outstanding: 2048 packets
dpa:          RTT timeout: 1500 usec
dpa:          TX/RX intrv: 20/0 usec
dpa:          TX/RX burst: 128/128
dpa:          TX/RX rings: 1024/1024
dpa:          TX/RX mpool: 65536/65536
dpa:          TX/RX cache: 512/512
dpa:             eal_port: 0000:41:00.1 (virtual=no)
dpa:           eal_lcores: 0-4
dpa:       eal_extra_args: n/a
dpa: ====================================================================================================
dpa: Using EAL args: dpa-dpdk -l 0-4 --main-lcore 0 --file-prefix dpa-dpdk -a 0000:41:00.1
EAL: Detected CPU lcores: 24
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/dpa-dpdk/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: No free 2048 kB hugepages reported on node 0
EAL: Probe PCI driver: mlx5_pci (15b3:101d) device: 0000:41:00.1 (socket -1)
dpa: DPDK link status: UP, speed: 100000
dpa: DPDK runtime ring size: RX=1024 TX=1024
dpa: Promiscuous mode disabled: success
dpa: Flow created: UDP dst=4242 -> queue 0
dpa: Flow created: UDP dst=4243 -> queue 1
dpa: Flow created: UDP dst=4244 -> queue 2
dpa: Flow created: UDP dst=4245 -> queue 3
Port configured with 4 RX queues and 4 TX queues
dpa: DPDK device configured succefully. Port: 0, address 10:70:FD:DF:A5:AB
dpa: DPDK eth link up. Speed 100000 Mbps Full-duplex
dpa.torch: pinned mempool enabled with 5 tensors of 100000000 bytes
[DDP] backend=dpa_dpdk world_size=6 master=42.0.1.1:29500 iface=ens4f1 local_rank=0
{
  "rank": 0,
  "world_size": 6,
  "iface": "ens4f1",
  "master_addr": "42.0.1.1",
  "master_port": 29500,
  "backend": "dpa_dpdk",
  "dpa_conf": "/home/gks/straggle-ml-experiments/configs/edgecore.json",
  "device": "cuda",
  "deterministic": true,
  "workers": 4,
  "prefetch_factor": 4,
  "static_graph": false,
  "seed": 42,
  "json": "experiments/train/lstm.json",
  "epochs": 12,
  "batch_size": 32,
  "learning_rate": 0.0015,
  "weight_decay": 1e-05,
  "num_classes": 2,
  "amp": false,
  "drop_last_train": false,
  "drop_last_val": false,
  "label_smoothing": 0.02,
  "cosine_min_lr_mult": 0.1,
  "max_len": 64,
  "max_vocab": 60000,
  "straggle_points": 0,
  "straggle_prob": 0,
  "straggle_ranks": [],
  "straggle_amount": 0,
  "straggle_multiply": [
    1.0,
    1.0
  ],
  "straggle_verbose": false,
  "prescale": false,
  "bucket_cap_mb": null,
  "hint_tensor_size": 100000000,
  "hint_tensor_count": 5,
  "local_rank": 0
}
[Vocab] size=14495 (includes PAD/UNK)
/home/gks/straggle-ml-experiments/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:626: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what
 this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Model 'lstm_big' initialized. (embed=300, hidden=512, layers=2, drop=0.6)
dpa.torch.py: DDP DPAState Object:  {'pipes': 0, 'straggle': 6, 'averaging': True, 'prescaled': False}
[straggle_sim][warning] created but effectively inactive -- points: 0, prob: 0.0, amount: 0.0
Straggle sim inactive
[2025-10-27 02:54:10][Epoch 000] ...
/home/gks/straggle-ml-experiments/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:626: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what
 this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
[2025-10-27 02:54:26][Epoch 000] train_loss=0.5641 (global=0.5638) val_loss=0.4821 top1=78.31% top5=100.00% lr=0.001254 epoch_time=16.28s step_time=0.05 (min=0.04s, max=1.05) tp=~701.7 samples/s straggle_events=0
[2025-10-27 02:54:26][Epoch 001] ...
[2025-10-27 02:54:42][Epoch 001] train_loss=0.3441 (global=0.3481) val_loss=0.4002 top1=82.88% top5=100.00% lr=0.001482 epoch_time=15.48s step_time=0.04 (min=0.04s, max=0.47) tp=~727.9 samples/s straggle_events=0
[2025-10-27 02:54:42][Epoch 002] ...
[2025-10-27 02:54:57][Epoch 002] train_loss=0.2456 (global=0.2419) val_loss=0.4035 top1=83.90% top5=100.00% lr=0.001410 epoch_time=15.50s step_time=0.04 (min=0.04s, max=0.48) tp=~727.3 samples/s straggle_events=0
[2025-10-27 02:54:57][Epoch 003] ...
[2025-10-27 02:55:13][Epoch 003] train_loss=0.1929 (global=0.1910) val_loss=0.4450 top1=84.02% top5=100.00% lr=0.001288 epoch_time=15.48s step_time=0.04 (min=0.04s, max=0.47) tp=~728.1 samples/s straggle_events=0
[2025-10-27 02:55:13][Epoch 004] ...
[2025-10-27 02:55:28][Epoch 004] train_loss=0.1630 (global=0.1599) val_loss=0.3874 top1=84.47% top5=100.00% lr=0.001128 epoch_time=15.52s step_time=0.04 (min=0.04s, max=0.47) tp=~726.2 samples/s straggle_events=0
[2025-10-27 02:55:28][Epoch 005] ...
[2025-10-27 02:55:44][Epoch 005] train_loss=0.1429 (global=0.1400) val_loss=0.4166 top1=84.25% top5=100.00% lr=0.000942 epoch_time=15.53s step_time=0.04 (min=0.04s, max=0.47) tp=~725.6 samples/s straggle_events=0
[2025-10-27 02:55:44][Epoch 006] ...
[2025-10-27 02:56:00][Epoch 006] train_loss=0.1198 (global=0.1253) val_loss=0.4363 top1=85.50% top5=100.00% lr=0.000747 epoch_time=15.55s step_time=0.04 (min=0.04s, max=0.47) tp=~725.1 samples/s straggle_events=0
[2025-10-27 02:56:00][Epoch 007] ...
[2025-10-27 02:56:15][Epoch 007] train_loss=0.1104 (global=0.1112) val_loss=0.4508 top1=84.82% top5=100.00% lr=0.000558 epoch_time=15.53s step_time=0.04 (min=0.04s, max=0.46) tp=~725.4 samples/s straggle_events=0
[2025-10-27 02:56:15][Epoch 008] ...
[2025-10-27 02:56:31][Epoch 008] train_loss=0.1059 (global=0.1049) val_loss=0.4308 top1=85.39% top5=100.00% lr=0.000391 epoch_time=15.57s step_time=0.04 (min=0.04s, max=0.47) tp=~723.7 samples/s straggle_events=0
[2025-10-27 02:56:31][Epoch 009] ...
[2025-10-27 02:56:46][Epoch 009] train_loss=0.0982 (global=0.0957) val_loss=0.5092 top1=84.36% top5=100.00% lr=0.000261 epoch_time=15.53s step_time=0.04 (min=0.04s, max=0.47) tp=~725.5 samples/s straggle_events=0
[2025-10-27 02:56:46][Epoch 010] ...
[2025-10-27 02:57:02][Epoch 010] train_loss=0.0914 (global=0.0916) val_loss=0.4870 top1=85.05% top5=100.00% lr=0.000178 epoch_time=15.58s step_time=0.04 (min=0.04s, max=0.47) tp=~723.2 samples/s straggle_events=0
[2025-10-27 02:57:02][Epoch 011] ...
[2025-10-27 02:57:17][Epoch 011] train_loss=0.0851 (global=0.0881) val_loss=0.4805 top1=84.82% top5=100.00% lr=0.000150 epoch_time=15.59s step_time=0.04 (min=0.04s, max=0.47) tp=~723.0 samples/s straggle_events=0
dpa: backend finished with pool[0:4096] seqnums: 73709,73709,73709,73709,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603,71604,71603...
dpa: ctx-1 killed by thread 1446497, 0 tasks ignored